# Telegram Tarot Bot

## Настройка

1. Скопируйте файл окружения и укажите токен бота и имя канала:
   ```bash
   cp .env.example .env
   ```
   Заполните:
   - `BOT_TOKEN` — токен, выданный [BotFather](https://t.me/BotFather).
   - `CHANNEL_USERNAME` — имя канала без `@`, в котором бот является администратором.

2. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```

3. Добавьте карты Таро:
   - Положите изображения (форматы `png`, `jpg`, `jpeg`) в папку `assets/cards/`.
   - Для расклада из 3 карт нужно минимум 3 изображения.

## Запуск

Запустите бота в режиме polling:
```bash
python main.py
```

Доступные команды:
- `/start` — проверка подписки на канал и выдача бесплатного расклада при первой проверке.

Доступные кнопки:
- Inline: "Подписаться" (ссылка на канал), "Проверить подписку" для повторной проверки.
- Reply: "Меню" — показывает количество доступных раскладов, "Получить расклад" — открывает выбор действия.
- При отсутствии раскладов: "Premium" (заглушка) и "Пригласить друга" (отправляет персональную реферальную ссылку).
- При наличии раскладов: "Карта дня" (отправляет случайную карту с изображением) и "Расклад из 3 карт" (коллаж 1×3 из случайных карт).

## Реферальная система

- Кнопка "Пригласить друга" отправляет ссылку вида `https://t.me/<BOT_USERNAME>?start=<user_id>`.
- Если новый пользователь запускает бота по этой ссылке, приглашавшему начисляется +1 расклад и увеличивается счётчик приглашённых. Повторное начисление за того же пользователя не происходит.
- Бонусы хранятся вместе с остальными данными в `data/users.json`.

> Для проверки подписки бот должен быть администратором канала, указанного в `CHANNEL_USERNAME`.
